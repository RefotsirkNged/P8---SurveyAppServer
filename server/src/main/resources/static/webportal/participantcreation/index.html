<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Indtast brugerinfo</title>
    <link rel="stylesheet" type="text/css" href="../style/stylesheet.css">
    <link rel="stylesheet" type="text/css" href="../style/bootstrap.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="../js/CookieHelper.js"></script>
    <script src="../js/bootstrap.min.js"></script>
</head>
<body>

<div id="loginfailedmodal" class="modal">
    <div class="modal-content">
        <span id="modalclose">&times;</span>
        <p id="loginfailedmessage"></p>
    </div>
</div>

<div class="wrapper center-container">
    <div class="container">
        <div class="row">
            <label>Fornavn</label>
        </div>
        <div class="row">
            <input class="form-control" name="firstname" id="firstname" type="text"/>
        </div>
        <div class="row">
            <label>Efternavn</label>
        </div>
        <div class="row">
            <input class="form-control" name="lastname" id="lastname" type="text"/>
        </div>
        <div class="row">
            <label>Email</label>
        </div>
        <div class="row">
            <input class="form-control" name="email" id="email" type="text"/>
        </div>
        <div class="row">
            <label>CPR-nr</label>
        </div>
        <div class="row">
            <input class="form-control" name="cprnr" id="cprnr" type="text"/>
        </div>
        <div class="row">
            <label>JournalNr</label>
        </div>
        <div class="row">
            <input class="form-control" name="journalnr" id="journalnr" type="text"/>
        </div>
        <div class="spacing">


        </div>
        <div class="row">
            <div class="col-6">
                <button type="button" class="btn btn-secondary btn-md" style="margin-top: 25px" onclick="home()">Tilbage</button>
            </div>
            <div class="col-6">
                <button type="button" class="btn btn-primary btn-md" style="margin-top: 25px" onclick="addUser()">Tilf√∏j bruger</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>

<script>
    function addUser(){
        $.ajax({
            type: 'POST',
            url: 'http://192.168.1.123:8081/api/participant',
            beforeSend: function (request) {
                cprval = document.getElementById("cprnr").value;
                emailval = document.getElementById("email").value;
                firstnameval = document.getElementById("firstname").value;
                lastnameval = document.getElementById("lastname").value;
                request.setRequestHeader("cpr", cprval);
                request.setRequestHeader("email", emailval);
                request.setRequestHeader("firstname", firstnameval);
                request.setRequestHeader("lastname", lastnameval);
            },
            success: function (response) {
                console.log(response);
                if(response.hasOwnProperty("error")){
                    modal.style.display = "block";
                    document.getElementById("loginfailedmessage").innerText = response.error;
                }
                else {
                    modal.style.display = "block";
                    document.getElementById("loginfailedmessage").innerText = "Deltager oprettet";
                }
            },
            error: function (response) {
                modal.style.display = "block";
                console.log(response);

                document.getElementById("loginfailedmessage").innerText = response.responseText;
            }
        });
    }

    var modal = document.getElementById("loginfailedmodal");
    var span = document.getElementById("modalclose");

    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    };

    span.onclick = function () {
        modal.style.display = "none";
    };

</script>